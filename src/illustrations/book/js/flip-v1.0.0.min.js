/*!
 * flip 1.0.0 - Copyright 2016 Terrill Dent, http://terrill.ca
 * Released under MIT license, http://terrill.ca/flipjs/license
 */
var flip=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,flip={},x=[],y=navigator.userAgent,z=/webkit/i.test(navigator.appVersion),A=/firefox/i.test(y),B=/trident/i.test(y),C=/safari/i.test(y),D=window.opera,E=z?"webkit":A?"":B?"ms":D?"O":"",F="transition",G=(E?E+"T":"t")+"ransform",H=(C?"-webkit-":"")+"transform",I=C?"webkitTransitionEnd":"transitionend",J=A?"px":"",K=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,1)}}(),L=(function(){return window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}(),[]);return flip.simulateTouch=!window.hasOwnProperty("ontouchstart"),b=function(){var a,b=o.startXY.x-o.curXY.x;return l?(a=180*b/Math.min(n/2,.9*o.startXY.x),a=s?Math.max(0,Math.min(180,a)):Math.min(60,Math.pow(a,.8))):(a=180*b/Math.min(n/2,.9*(n-o.startXY.x)),a=q?180-Math.abs(Math.min(0,Math.max(-180,a))):Math.max(120,180-Math.pow(Math.abs(a),.8))),a},a=function(){n=window.innerWidth},d=function(){flip.transitioning=!1,flip.autotransition=!1,k.style.display="none",i.style.display="none",setTimeout(function(){flip.fire("globalTransitionEnd")},0)},e=function(){d(),v&&v.removeEventListener(I,e,!1),w&&w.removeEventListener(I,e,!1),l?(s&&(s.html.style.display="none"),flip.removeClass(r.html,"left")):(q&&(q.html.style.display="none"),flip.removeClass(r.html,"right")),setTimeout(function(){r.onStay()},0)},f=function(){s&&flip.removeClass(s.html,"right"),d(),r.html.style.display="none",L.push(r),v&&v.removeEventListener(I,f,!1),q&&(flip.remove(q.html),flip.remove(q.flip)),q=r,r=s,s=null,"block"!==r.html.style.display&&(r.html.style.display="block"),r.onShowComplete(L.length)},g=function(){q&&flip.removeClass(q.html,"left"),d(),r.html.style.display="none",L.pop(),w&&w.removeEventListener(I,g,!1),s&&(flip.remove(s.html),flip.remove(s.flip)),s=r,r=q,q=null,L.length>0&&(q=L[L.length-1]||null,q.html.style.display="none",h.appendChild(q.html),q.flip.style.display="none",i.appendChild(q.flip)),r.onShowComplete(L.length)},p={breach:function(a){flip.transitioning=!0,m=null,a>0?(l=!0,t=r.html,w=r.flip,u=s?s.html:null,v=s?s.flip:null):(l=!1,u=r.html,v=r.flip,t=q?q.html:null,w=q?q.flip:null),flip.autotransition||(flip.addClass(i,"dragging"),v&&(v.style[F]=H+" 0s",v.removeEventListener(I,e,!1),v.removeEventListener(I,f,!1)),w&&(w.style[F]=H+" 0s",w.removeEventListener(I,e,!1),w.removeEventListener(I,g,!1))),r.onObscure(),l&&q?q.html.style.display="none":s&&(s.html.style.display="none"),u&&(flip.addClass(u,"right"),flip.removeClass(u,"left"),u.style.display="block"),t&&(flip.addClass(t,"left"),flip.removeClass(t,"right"),t.style.display="block"),w&&(flip.addClass(w,"right"),flip.removeClass(w,"left"),w.style.display="block"),v&&(flip.addClass(v,"left"),flip.removeClass(v,"right"),v.style.display="block"),k.style.display="block",k.style.opacity=0,i.style.display="block"},reset:function(){if(v||w){var a,c,d=b();m=null,flip.removeClass(i,"dragging"),l?(a=f,c=e):(a=e,c=g),0===d?c():d>=180?a():90>d&&w?(w.style[G]="translateX( 0 ) perspective( 3000"+J+") rotateY( -0deg )",w.style[F]=H+" "+500*d/90+"ms ease-in",w.addEventListener(I,c,!1)):v&&(v.style[G]="translateX( 0 ) perspective( 3000"+J+") rotateY( -360deg )",v.style[F]=H+" "+500*(180-d)/90+"ms ease-in",v.addEventListener(I,a,!1))}},move:function(){flip.waiting||(K(c),flip.waiting=!0)}},c=function(){if(v||w){var a=b();90>a?((!m||m>=90)&&v&&(v.style[G]="translateX( 4000px )"),w.style[G]="translateX( 0 ) perspective( 3000"+J+") rotateY( -"+a+"deg )"):a>=90&&((!m||90>m)&&w&&(w.style[G]="translateX( 4000px )"),v.style[G]="translateX( 0 ) perspective( 3000"+J+") rotateY( -"+(180+a)+"deg )"),m=a,flip.waiting=!1}},flip.remove=function(a){a.parentNode&&a.parentNode.removeChild(a)},flip.forEach=function(a,b){var c,d=a.length;for(c=0;d>c;c++)b(a[c])},flip.hasClass=function(a,b){return a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))},flip.addClass=function(a,b){flip.hasClass(a,b)||(a.className+=" "+b)},flip.removeClass=function(a,b){if(flip.hasClass(a,b)){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ")}},flip.addListener=function(a){x.push(a)},flip.removeListener=function(a){var b=x.indexOf(a);b>=0&&x.splice(x.indexOf(a),1)},flip.fire=function(a,b){flip.forEach(x,function(c){c&&c[a]&&c[a](b)})},flip.close=function(){r!==j&&(L.length>1&&(q&&(flip.remove(q.flip),flip.remove(q.html)),L.splice(0,L.length-1),q=j,q.html.style.display="",h.insertBefore(q.html,r.html),i.insertBefore(q.flip,r.flip),r.refreshFlip()),flip.pop())},flip.pop=function(){var a;r!==j&&setTimeout(function(){var b="translateX(0px) perspective(3000"+J+") ";flip.autotransition=!0,p.breach(-20,0),w.style[G]=b+"rotateY( -90deg )",v.style[G]=b+"rotateY( -360deg )",w.style[F]=H+" 300ms ease-in",v.style[F]=H+" 300ms ease-in",setTimeout(function(){a=function(){v.removeEventListener(I,a,!1),w.style[G]=b+"rotateY( 0deg )",setTimeout(g,400)},v.addEventListener(I,a,!1),v.style[G]=b+"rotateY( -270deg )"},10)},0)},flip.push=function(a){var b;j?(flip.autotransition=!0,flip.prime(a),setTimeout(function(){var a="translateX( 0 ) perspective(3000"+J+") ";p.breach(20,0),w.style[G]=a+"rotateY( 0deg )",v.style[G]=a+"rotateY( 90deg )",w.style[F]=H+" 300ms ease-in",v.style[F]=H+" 300ms ease-in",setTimeout(function(){b=function(){w.removeEventListener(I,b,!1),v.style[G]=a+"rotateY( 0deg )",setTimeout(f,400)},w.addEventListener(I,b,!1),w.style[G]=a+"rotateY( -90deg )"},10)},0)):(r=a,j=r,h.appendChild(r.html),i.appendChild(r.flip),r.onShowComplete(L.length))},flip.getStackHeight=function(){return L.length},flip.prime=function(a){s&&s!==a&&(flip.remove(s.html),flip.remove(s.flip)),s=a,s.html.style.display="none",h.appendChild(s.html),s.flip.style.display="none",i.appendChild(s.flip)},flip.createElem=function(a,b){var c,d=document.createElement(a);for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);return d},flip.init=function(b,c){var d=document.createDocumentFragment();h=flip.createElem("div",{className:"flip-base-pages"}),i=flip.createElem("div",{className:"flip-pages"}),k=flip.createElem("div",{className:"flip-shadow"}),d.appendChild(h),d.appendChild(k),d.appendChild(i),b.appendChild(d),c&&flip.push(c),o=flip.draggable.create(h,p,10),window.addEventListener("resize",a,!1),a()},flip}(),flip=window.flip;flip.basic=function(a){if(a="string"==typeof a?document.getElementById(a):a,1!==a.childNodes.length&&console.err)return void console.err("Expects a single child that contains all the page elements");var b,c,d,e=[];for(c=a.firstElementChild,d=function(a){e[a+1]&&flip.prime(e[a+1])},c.parentNode.removeChild(c);c.firstElementChild;)b=c.firstElementChild,b.parentNode.removeChild(b),e.push(flip.page.create(b,{onShowComplete:d}));flip.init(a,e[0])};var flip=window.flip;flip.draggable=function(){var a={getPagePosition:function(a){return a=a.touches?a.touches[0]:a,{x:a.pageX,y:a.pageY}},handleEvent:function(a){var b=this;switch(a.type){case"touchstart":case"mousedown":b.handleTouchStart(a);break;case"touchmove":case"mousemove":b.handleTouchMove(a);break;case"touchend":case"mouseup":b.handleTouchEnd(a);break;case"mouseout":a.relatedTarget&&"HTML"===a.relatedTarget.tagName&&b.handleTouchEnd(a)}},reset:function(){var a=this;document.body.removeEventListener("touchmove",a,!1),document.body.removeEventListener("touchend",a,!1),flip.simulateTouch&&(document.body.removeEventListener("mousemove",a,!1),document.body.removeEventListener("mouseup",a,!1),window.removeEventListener("mouseout",a,!1)),a.curXY&&(a.listener.reset&&a.listener.reset(),a.curXY=null)},handleTouchStart:function(a){var b=this;return a.preventDefault(),b.curXY&&a.touches&&a.touches.length>1?void b.reset():void((a.touches&&a.touches.length)>1||a.which&&3===a.which||a.button&&2===a.button||(b.outsideBuffer=!1,b.curXY=null,document.body.addEventListener("touchmove",b,!1),document.body.addEventListener("touchend",b,!1),flip.simulateTouch&&(document.body.addEventListener("mousemove",b,!1),document.body.addEventListener("mouseup",b,!1),window.addEventListener("mouseout",b,!1)),b.startXY=b.getPagePosition(a),b.curXY=b.startXY,b.listener.start&&b.listener.start()))},handleTouchMove:function(a){var b,c,d=this;return a.preventDefault(),a.touches&&a.touches.length>1?void d.reset():(d.curXY=d.getPagePosition(a),c=d.startXY.x-d.curXY.x,b=d.startXY.y-d.curXY.y,d.buffer&&!d.outsideBuffer&&Math.abs(c)>=d.buffer&&(d.listener.breach&&d.listener.breach(c,b),d.outsideBuffer=!0),void((!d.buffer||d.outsideBuffer)&&d.listener.move&&d.listener.move()))},handleTouchEnd:function(a){var b=this;a.preventDefault(),b.reset()}};return{create:function(b,c,d){var e=Object.create(a);return e.target=b,e.listener=c,e.buffer=d,b.addEventListener("touchstart",e,!1),flip.simulateTouch&&b.addEventListener("mousedown",e,!1),e}}}();var flip=window.flip;flip.page=function(){var a={refreshFlip:function(){var a,b=this,c=b.flip;return flip.transitioning?void(b.dirty||(b.dirty=!0,flip.addListener(b))):(b.dirty&&(b.dirty=!1,flip.removeListener(b)),b.flip=b.html.cloneNode(!0),void(c&&c.parentNode&&(a=c.parentNode,a&&(a.removeChild(c),a.appendChild(b.flip)))))},globalTransitionEnd:function(){this.refreshFlip()},onObscure:function(){var a=this;a.listener.onObscure&&a.listener.onObscure()},onStay:function(){var a=this;a.listener.onStay&&a.listener.onStay()},onShowComplete:function(a){var b=this;b.listener.onShowComplete&&b.listener.onShowComplete(a),b.onStay()}};return{create:function(b,c){var d=Object.create(a);return flip.addClass(b,"flip-page"),d.listener=c,d.html=flip.createElem("div",{className:"flip-page-wrapper"}),d.html.appendChild(b),d.flip=d.html.cloneNode(!0),d}}}();